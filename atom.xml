<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>崎径 其镜</title>
  <subtitle>求学道路上的行车记录仪</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://www.z16388.top/"/>
  <updated>2019-12-01T16:48:03.109Z</updated>
  <id>http://www.z16388.top/</id>
  
  <author>
    <name>Anqi Zhao</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>震惊，JS不加分号会造成错误！？</title>
    <link href="http://www.z16388.top/2019/12/02/%E9%9C%87%E6%83%8Ajs/"/>
    <id>http://www.z16388.top/2019/12/02/震惊js/</id>
    <published>2019-12-01T16:12:19.000Z</published>
    <updated>2019-12-01T16:48:03.109Z</updated>
    
    <content type="html"><![CDATA[<p>在之前的工作中，我遇到了一个奇怪的问题。明明在语法上没有问题，找同事也看了，但是程序依旧会产生奇怪的错误。最后通过一步一步断点，定为了错误位置，才找到了造成这个错误的原因———在一个不需要分号的语言中，句末不加分号居然报错了。</p>
<p>不卖关子了，这个错误是多返回值函数造成了对上一句值的影响。下面举个例子：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">func</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> [<span class="number">1</span>, <span class="number">2</span>]</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">let</span> b = <span class="number">0</span></div><div class="line"><span class="keyword">let</span> c = <span class="number">0</span></div><div class="line"><span class="keyword">let</span> a = <span class="number">3</span></div><div class="line">[b, c] = func();</div><div class="line"><span class="built_in">console</span>.log(<span class="string">"a is :"</span> + a)</div><div class="line"><span class="built_in">console</span>.log(<span class="string">"b is :"</span> + b + <span class="string">" c is :"</span> + c)</div></pre></td></tr></table></figure>
<p>运行的结果将会是这样:</p>
<blockquote>
<p>a is :1,2<br>b is :0 c is :0</p>
</blockquote>
<p>很容易看到，我们函数的返回值给了上一行的a。这是因为我们的编译器将代码认为了：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> a = <span class="number">3</span> ,[b, c] = func();</div></pre></td></tr></table></figure>
<p>避免这种情况，还是要多加分号吧——虽然它并不会报错。</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;在之前的工作中，我遇到了一个奇怪的问题。明明在语法上没有问题，找同事也看了，但是程序依旧会产生奇怪的错误。最后通过一步一步断点，定为了错误位置，才找到了造成这个错误的原因———在一个不需要分号的语言中，句末不加分号居然报错了。&lt;/p&gt;
&lt;p&gt;不卖关子了，这个错误是多返回值函
    
    </summary>
    
    
      <category term="JavaScript" scheme="http://www.z16388.top/tags/JavaScript/"/>
    
  </entry>
  
  <entry>
    <title>Linux升级Python</title>
    <link href="http://www.z16388.top/2019/11/28/linuxuppy/"/>
    <id>http://www.z16388.top/2019/11/28/linuxuppy/</id>
    <published>2019-11-28T04:12:19.000Z</published>
    <updated>2019-12-01T17:10:37.987Z</updated>
    
    <content type="html"><![CDATA[<p>11月底，腾讯云搞了一波双11返场活动，我买了三年的服务器。</p>
<p>和买了新的电脑或者做了新系统一样，得先把生产环境搞好。</p>
<p>距离Python2.x停止维护大概只有5个月了吧，所以第一要务是升级Python的版本。但是yum是依赖Python2的，所以升级还是会有一些顾虑的。下面是升级的过程：</p>
<h1 id="下载、解压"><a href="#下载、解压" class="headerlink" title="下载、解压"></a>下载、解压</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">wget https://www.python.org/ftp/python/3.8.0/Python-3.8.0.tgz</div><div class="line">tar -zxvf Python-3.8.0.tgz</div></pre></td></tr></table></figure>
<h1 id="安装编译环境"><a href="#安装编译环境" class="headerlink" title="安装编译环境"></a>安装编译环境</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">yum install make build-essential libssl-dev zlib1g-dev libbz2-dev</div><div class="line">yum install zlib</div></pre></td></tr></table></figure>
<h1 id="编译、安装"><a href="#编译、安装" class="headerlink" title="编译、安装"></a>编译、安装</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">yum install -y make build-essential libssl-dev zlib1g-dev libbz2-dev</div><div class="line">yum -y install zlib</div><div class="line"></div><div class="line">cd Python-3.8.0</div><div class="line">./configure</div><div class="line">make &amp;&amp; make install</div></pre></td></tr></table></figure>
<h1 id="备份与配置"><a href="#备份与配置" class="headerlink" title="备份与配置"></a>备份与配置</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">mv /usr/bin/python /usr/bin/python.bak</div><div class="line">ln -s /usr/local/bin/python3 /usr/bin/python</div></pre></td></tr></table></figure>
<h1 id="保证yum可用"><a href="#保证yum可用" class="headerlink" title="保证yum可用"></a>保证yum可用</h1><p>将下面文件中的配置修改为Python2.x版本的路径。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">/usr/bin/yum</div><div class="line">/usr/libexec/urlgrabber-ext-down</div></pre></td></tr></table></figure>
<h1 id="安装pip"><a href="#安装pip" class="headerlink" title="安装pip"></a>安装pip</h1><p>pip需要依赖setuptools，所以要先安装setuptools。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">wget https://files.pythonhosted.org/packages/ce/1d/96320b9784b04943c924a9f1c6fa49124a1542039ce098a5f9a369227bad/setuptools-42.0.1.zip</div><div class="line">unzip setuptools-42.0.1.zip</div><div class="line">cd setuptools-42.0.1</div><div class="line">python setup.py build</div><div class="line">python setup.py install</div><div class="line"></div><div class="line">wget https://files.pythonhosted.org/packages/ce/ea/9b445176a65ae4ba22dce1d93e4b5fe182f953df71a145f557cffaffc1bf/pip-19.3.1.tar.gz</div><div class="line">tar -zxvf pip-19.3.1.tar.gz</div><div class="line">cd pip-19.3.1</div><div class="line">python setup.py build</div><div class="line">python setup.py install</div></pre></td></tr></table></figure>
<h1 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h1><p><a href="https://www.cnblogs.com/zhangym/p/6226435.html" target="_blank" rel="external">https://www.cnblogs.com/zhangym/p/6226435.html</a><br><a href="https://www.cnblogs.com/fjping0606/p/9156344.html" target="_blank" rel="external">https://www.cnblogs.com/fjping0606/p/9156344.html</a><br><a href="https://www.cnblogs.com/fyly/p/11112169.html" target="_blank" rel="external">https://www.cnblogs.com/fyly/p/11112169.html</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;11月底，腾讯云搞了一波双11返场活动，我买了三年的服务器。&lt;/p&gt;
&lt;p&gt;和买了新的电脑或者做了新系统一样，得先把生产环境搞好。&lt;/p&gt;
&lt;p&gt;距离Python2.x停止维护大概只有5个月了吧，所以第一要务是升级Python的版本。但是yum是依赖Python2的，所以升
    
    </summary>
    
    
      <category term="Python" scheme="http://www.z16388.top/tags/Python/"/>
    
      <category term="Linux" scheme="http://www.z16388.top/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>Github图床工具</title>
    <link href="http://www.z16388.top/2019/11/17/picupdate/"/>
    <id>http://www.z16388.top/2019/11/17/picupdate/</id>
    <published>2019-11-17T10:32:44.000Z</published>
    <updated>2019-11-17T10:33:15.419Z</updated>
    
    <content type="html"><![CDATA[<p>这是一个上传图片到github的工具，目前还不是很成熟，不过已经可以实现压缩并上传图片的目的了，对于写博客来说已经够用了。</p>
<h1 id="使用步骤"><a href="#使用步骤" class="headerlink" title="使用步骤"></a>使用步骤</h1><ol>
<li>创建todo目录</li>
<li>创建pic目录，在github上创建一个空项目，然后pull到这里</li>
<li>修改配置文件，将git_url修改为上一步新建的项目</li>
<li>将图片放到todo文件夹下</li>
<li>执行工具</li>
</ol>
<p>需要注意的是，因为图床需要一个git目录，同时代码也需要。在使用部分git管理工具时会禁止这种目录的嵌套。因此最好将代码独立运行。可以自己打包，也可以使用我打好的可执行程序。</p>
<p>在这里需要提一句，一般如果只想要下载github上项目的一个目录或者一个文件，可以使用svn进行下载。将文件路径中的<code>文件名/master</code>替换为<code>trunk</code>即可使用下载。</p>
<p>经过配置之后，以后只需要将图片放到todo目录下，执行脚本即可。</p>
<p>编译时需要安装以下运行库</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">pip install pyyaml</div><div class="line">pip install gitpython</div><div class="line">pip install pillow</div></pre></td></tr></table></figure>
<h1 id="更新文档"><a href="#更新文档" class="headerlink" title="更新文档"></a>更新文档</h1><p>Ver.0.2 2019-11-17 提交编译的可执行程序；增加配置文件</p>
<p>Ver.0.1 2019-11-12 提交项目</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;这是一个上传图片到github的工具，目前还不是很成熟，不过已经可以实现压缩并上传图片的目的了，对于写博客来说已经够用了。&lt;/p&gt;
&lt;h1 id=&quot;使用步骤&quot;&gt;&lt;a href=&quot;#使用步骤&quot; class=&quot;headerlink&quot; title=&quot;使用步骤&quot;&gt;&lt;/a&gt;使用步骤&lt;
    
    </summary>
    
    
      <category term="Python" scheme="http://www.z16388.top/tags/Python/"/>
    
      <category term="Github" scheme="http://www.z16388.top/tags/Github/"/>
    
  </entry>
  
  <entry>
    <title>JS使用replace()函数全部替换</title>
    <link href="http://www.z16388.top/2019/11/16/jsreplace/"/>
    <id>http://www.z16388.top/2019/11/16/jsreplace/</id>
    <published>2019-11-16T14:03:56.000Z</published>
    <updated>2019-11-16T14:03:21.249Z</updated>
    
    <content type="html"><![CDATA[<p>在处理爬虫爬取下来的数据时，遇到了在文字中出现了经过转义的换行符，在文中显示出了\n，很影响观赏效果。因此，我对内容做了处理。</p>
<p>但是在刷库的过程中，我发现，我总不能一次处理完所有的数据。后来发现是JavaScript的Replace函数的问题，这个函数默认只能替换第一个匹配到的项目。如果需要处理全部的，需要使用正则表达式：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">string.replace(<span class="regexp">/\\n/g</span>, <span class="string">"\n"</span>)</div></pre></td></tr></table></figure>
<p>除此之外，下面是一些处理爬取内容常用操作，包含了html的转义：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">string.replace(<span class="regexp">/&amp;nbsp;/g</span>, <span class="string">' '</span>)</div><div class="line">string.replace(<span class="regexp">/&amp;lt;/g</span>, <span class="string">'&lt;'</span>)</div><div class="line">string.replace(<span class="regexp">/&amp;gt;/g</span>, <span class="string">'&gt;'</span>)</div><div class="line">string.replace(<span class="regexp">/&amp;amp;/g</span>, <span class="string">'&amp;'</span>)</div><div class="line">string.replace(<span class="regexp">/&amp;quot;/g</span>, <span class="string">'"'</span>)</div><div class="line">   string.replace(<span class="regexp">/&amp;#x3D;/g</span>, <span class="string">'='</span>)</div><div class="line">   string.replace(<span class="regexp">/\[.*?\]/g</span>,<span class="string">''</span>)</div><div class="line">   string.replace(<span class="string">"\\n"</span>,<span class="string">"\n"</span>)</div><div class="line">   string.replace(<span class="string">"\\t"</span>,<span class="string">""</span>)</div><div class="line">   string.replace(<span class="string">"\\r"</span>,<span class="string">""</span>)</div></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;在处理爬虫爬取下来的数据时，遇到了在文字中出现了经过转义的换行符，在文中显示出了\n，很影响观赏效果。因此，我对内容做了处理。&lt;/p&gt;
&lt;p&gt;但是在刷库的过程中，我发现，我总不能一次处理完所有的数据。后来发现是JavaScript的Replace函数的问题，这个函数默认只能
    
    </summary>
    
    
      <category term="JavaScript" scheme="http://www.z16388.top/tags/JavaScript/"/>
    
  </entry>
  
  <entry>
    <title>JS使用Splice()函数操作数组</title>
    <link href="http://www.z16388.top/2019/11/16/jssplice/"/>
    <id>http://www.z16388.top/2019/11/16/jssplice/</id>
    <published>2019-11-16T13:59:56.000Z</published>
    <updated>2019-11-16T14:00:02.652Z</updated>
    
    <content type="html"><![CDATA[<p>在js的使用过程中，有一次需要对数组进行各种操作，一时间迫使我想要去使用链表。后来通过查阅资料，总结了下面的一些方法，主要使用了splice()函数。</p>
<p>下面的方法主要是使用下标进行操作。如果是用值的话，可以通过<code>indexOf()</code>函数来获取下标。若不存在则返回-1。</p>
<p>值交换</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">swap_arr</span>(<span class="params">a_list, index1, index2</span>) </span>&#123;</div><div class="line">    a_list[index1] = a_list.splice(index2, <span class="number">1</span>, a_list[index1])[<span class="number">0</span>];</div><div class="line">    <span class="keyword">return</span> a_list;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>置顶</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">up_arr</span>(<span class="params">a_list, index</span>)</span>&#123;</div><div class="line">    <span class="keyword">if</span>(index!=<span class="number">0</span> &amp;&amp; index!=<span class="number">-1</span>)&#123;</div><div class="line">        a_list[index] = a_list.splice(index<span class="number">-1</span>, <span class="number">1</span>, a_list[index])[<span class="number">0</span>];</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>下移</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">down_arr</span>(<span class="params">a_list, index</span>) </span>&#123;</div><div class="line">    <span class="keyword">if</span>(index!=a_list.length<span class="number">-1</span> &amp;&amp; index!=<span class="number">-1</span>)&#123;</div><div class="line">        a_list[index] = a_list.splice(index+<span class="number">1</span>, <span class="number">1</span>, a_list[index])[<span class="number">0</span>];</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>插入</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">ins_arr</span>(<span class="params">a_list, index, a_data</span>) </span>&#123;</div><div class="line">    <span class="keyword">if</span>(index!=<span class="number">-1</span>)&#123;</div><div class="line">        <span class="keyword">if</span> (a_list.indexOf(a_data)==<span class="number">-1</span>) &#123;</div><div class="line">            a_list.splice(index+<span class="number">1</span>, <span class="number">0</span>, a_data);</div><div class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">else</span> &#123;</div><div class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>在顶部插入</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">topins_arr</span>(<span class="params">a_list, a_data</span>) </span>&#123;</div><div class="line">    a_list.splice(<span class="number">0</span>, <span class="number">0</span>, a_data)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>删除元素</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">del_arr</span>(<span class="params">a_list, a_data_list</span>) </span>&#123;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">const</span> ele <span class="keyword">of</span> a_data_list) &#123;</div><div class="line">        <span class="keyword">let</span> index = a_list.indexOf(ele);</div><div class="line">        <span class="keyword">if</span>(index!=<span class="number">-1</span>)&#123;</div><div class="line">            a_list.splice(index, <span class="number">1</span>);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;在js的使用过程中，有一次需要对数组进行各种操作，一时间迫使我想要去使用链表。后来通过查阅资料，总结了下面的一些方法，主要使用了splice()函数。&lt;/p&gt;
&lt;p&gt;下面的方法主要是使用下标进行操作。如果是用值的话，可以通过&lt;code&gt;indexOf()&lt;/code&gt;函数来
    
    </summary>
    
    
      <category term="JavaScript" scheme="http://www.z16388.top/tags/JavaScript/"/>
    
  </entry>
  
  <entry>
    <title>当你的程序连接Mysql然后崩溃时</title>
    <link href="http://www.z16388.top/2019/11/16/mysqltimeout/"/>
    <id>http://www.z16388.top/2019/11/16/mysqltimeout/</id>
    <published>2019-11-16T13:43:56.000Z</published>
    <updated>2019-11-16T13:47:13.465Z</updated>
    
    <content type="html"><![CDATA[<p>之前写过一个监控mysql数据库更新状态的预警程序，总是莫名其妙的报一个连接错误的错，然后程序死掉。后来在系统趋于稳定之后，我就没再继续维护这个工具了。</p>
<p>但是最近我在写另一个工具时，遇到了一个奇怪的问题，就是：tick总在27000多左右的时候崩溃。</p>
<p>我进行了一系列的猜测，比如tick的代码，或者是逻辑有问题，最后我把思路放在了之前遇到的这个错误上。查阅资料后发现，MySQL数据库在连接之后，如果超过一个设定的时间戳之后，会断开。这个值叫<code>WAIT_TIMEOUT</code>，默认值是28800，也就是说如果连上MySQL数据库之后，8小时内没有进行操作，这个连接便会断开。</p>
<p>网上很多连接MySQL数据库的代码没有处理过超时连接的问题，就连JS的官方代码好像也是在17年之后才更新的。以往这个问题，大家都是通过修改这个值来进行规避的。比如改成300天。修改有两种方式，一种是修改配置文件，这样在启动时便会使用这个配置；另一种是修改这个值，或者全局，或者当次生效。</p>
<p>下面是我在使用JavaScript语言链接MySQL数据库时，处理超时重连问题的代码：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line">this.config = &#123;</div><div class="line">    "host": "x.x.x.x",</div><div class="line">	"port": xxxx,</div><div class="line">	"user": "root",</div><div class="line">	"password": "pass",</div><div class="line">	"database": "name""</div><div class="line">&#125;		</div><div class="line"></div><div class="line">async connect() &#123;</div><div class="line">    let self = this;</div><div class="line">    console.log("connect mysql success with", JSON.stringify(this.config))</div><div class="line">    // 创建连接</div><div class="line">    this.db_mysql = mysql.createConnection(</div><div class="line">        this.config</div><div class="line">    );</div><div class="line">    // 连接数据库</div><div class="line">    await this.db_mysql.connect();</div><div class="line">    // 错误处理</div><div class="line">    this.db_mysql.on('error', function(err) &#123;</div><div class="line">        if (err) &#123;</div><div class="line">            if (err.code === 'PROTOCOL_CONNECTION_LOST') &#123;</div><div class="line">                // 处理超时</div><div class="line">                console.warning("start reconnect mysql");</div><div class="line">                self.connect();</div><div class="line">            &#125; else &#123;</div><div class="line">                console.error(err.stack || err);</div><div class="line">                console.warning("start reconnect mysql");</div><div class="line">                self.connect();</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;之前写过一个监控mysql数据库更新状态的预警程序，总是莫名其妙的报一个连接错误的错，然后程序死掉。后来在系统趋于稳定之后，我就没再继续维护这个工具了。&lt;/p&gt;
&lt;p&gt;但是最近我在写另一个工具时，遇到了一个奇怪的问题，就是：tick总在27000多左右的时候崩溃。&lt;/p&gt;

    
    </summary>
    
    
      <category term="JavaScript" scheme="http://www.z16388.top/tags/JavaScript/"/>
    
      <category term="MySQL" scheme="http://www.z16388.top/tags/MySQL/"/>
    
  </entry>
  
  <entry>
    <title>安卓应用闪屏</title>
    <link href="http://www.z16388.top/2019/11/16/AndroidSplash/"/>
    <id>http://www.z16388.top/2019/11/16/AndroidSplash/</id>
    <published>2019-11-16T13:19:56.000Z</published>
    <updated>2019-11-16T13:41:45.264Z</updated>
    
    <content type="html"><![CDATA[<p>去年在接入安卓SDK时，会有部分渠道有要求手写闪屏的情况，下面是当时的笔记，这只是最简单的一种方法。</p>
<h1 id="参考资料："><a href="#参考资料：" class="headerlink" title="参考资料："></a>参考资料：</h1><p>很好的例子：</p>
<p><a href="https://www.jianshu.com/p/a609f510b19a" target="_blank" rel="external">https://www.jianshu.com/p/a609f510b19a</a></p>
<p><a href="https://blog.csdn.net/l799069596/article/details/47094731" target="_blank" rel="external">https://blog.csdn.net/l799069596/article/details/47094731</a></p>
<p>安卓动画：<a href="https://blog.csdn.net/IO_Field/article/details/53101499" target="_blank" rel="external">https://blog.csdn.net/IO_Field/article/details/53101499</a></p>
<h1 id="背景："><a href="#背景：" class="headerlink" title="背景："></a>背景：</h1><p>除去游戏本身的闪屏之外，有的渠道会要求，有额外的渠道闪屏。为了使用一套资源出不同渠道包，我们可以对接渠道的AS工程进行处理，单独设置闪屏。</p>
<p>首先，创建一个闪屏Activity，为你的主Activity，这样在游戏的一开始你就可以看到闪屏了。</p>
<p>这里需要注意的是，你原先的Activit也需要在Manifest中注册打开日志，否则在打包的时候会找不到，报错：</p>
<p><a href="https://blog.csdn.net/qq_28301007/article/details/52265775" target="_blank" rel="external">https://blog.csdn.net/qq_28301007/article/details/52265775</a></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">activity</span> <span class="attr">android:name</span>=<span class="string">"...Activity"</span>/&gt;</span></div></pre></td></tr></table></figure>
<p>下面是主Activity，也就是闪屏Activity的代码，需要根据AS的提示import缺少的部分。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> android.animation.ObjectAnimator;</div><div class="line"><span class="keyword">import</span> android.animation.ValueAnimator;</div><div class="line"><span class="keyword">import</span> android.app.Activity;</div><div class="line"><span class="keyword">import</span> android.content.Intent;</div><div class="line"><span class="keyword">import</span> android.os.Bundle;</div><div class="line"><span class="keyword">import</span> android.os.Handler;</div><div class="line"><span class="keyword">import</span> android.view.WindowManager;</div><div class="line"><span class="keyword">import</span> android.widget.ImageView;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SplashActivity</span> <span class="keyword">extends</span> <span class="title">Activity</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">int</span> TimeAnimDurning = <span class="number">2000</span>;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span> displayDeviceWidth;</div><div class="line">    ImageView iv_splash;</div><div class="line">    <span class="keyword">private</span> ObjectAnimator objAnim;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</div><div class="line">        displayDeviceWidth = getResources().getDisplayMetrics().widthPixels;</div><div class="line">        setContentView(R.layout.activity_splash);</div><div class="line">        iv_splash = (ImageView) findViewById(R.id.splash);</div><div class="line">        objAnim = ObjectAnimator.ofFloat(iv_splash,<span class="string">"alpha"</span>,<span class="number">1</span>,<span class="number">0</span>);</div><div class="line">        objAnim.setDuration(TimeAnimDurning);</div><div class="line"></div><div class="line">        <span class="keyword">new</span> Handler().postDelayed(<span class="keyword">new</span> Runnable() &#123;</div><div class="line">            <span class="meta">@Override</span></div><div class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</div><div class="line">                objAnim.addUpdateListener(<span class="keyword">new</span> ValueAnimator.AnimatorUpdateListener() &#123;</div><div class="line">                    <span class="meta">@Override</span></div><div class="line">                    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onAnimationUpdate</span><span class="params">(ValueAnimator animation)</span> </span>&#123;</div><div class="line">                        <span class="keyword">if</span>((<span class="keyword">int</span>)animation.getAnimatedFraction() == <span class="number">1</span>)&#123;</div><div class="line">                            getWindow().clearFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN);</div><div class="line">                            startActivity(<span class="keyword">new</span> Intent(SplashActivity.<span class="keyword">this</span> , .YouActivity.class));</div><div class="line">                            finish();</div><div class="line">                            <span class="keyword">return</span> ;</div><div class="line">                        &#125;</div><div class="line">                    &#125;</div><div class="line">                &#125;);</div><div class="line">                objAnim.start();</div><div class="line">            &#125;</div><div class="line"></div><div class="line">        &#125;, <span class="number">2000</span>);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version="1.0" encoding="utf-8"?&gt;</div><div class="line"><span class="tag">&lt;<span class="name">RelativeLayout</span></span></div><div class="line">    <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></div><div class="line">    <span class="attr">xmlns:tools</span>=<span class="string">"http://schemas.android.com/tools"</span></div><div class="line">    <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></div><div class="line">    <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span></div><div class="line">    <span class="attr">android:background</span>=<span class="string">"@color/white"</span></div><div class="line">    <span class="attr">tools:context</span>=<span class="string">"com.unity3d.player.SplashActivity"</span>&gt;</div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">LinearLayout</span></span></div><div class="line">    <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></div><div class="line">    <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span></div><div class="line">    <span class="attr">android:visibility</span>=<span class="string">"visible"</span>&gt;</div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="name">ImageView</span></span></div><div class="line">        <span class="attr">android:id</span>=<span class="string">"@+id/splash"</span></div><div class="line">        <span class="attr">android:layout_width</span>=<span class="string">"0dp"</span></div><div class="line">        <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span></div><div class="line">        <span class="attr">android:layout_weight</span>=<span class="string">"1"</span></div><div class="line">        <span class="attr">android:scaleType</span>=<span class="string">"fitXY"</span></div><div class="line">        <span class="attr">android:src</span>=<span class="string">"@drawable/splash"</span> /&gt;</div><div class="line"></div><div class="line"><span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">RelativeLayout</span>&gt;</span></div></pre></td></tr></table></figure>
<p>在上面控制闪屏格式的style.xml中，可以看到闪屏的背景色设置为了白色。这里有一些常用的颜色xml：<a href="https://blog.csdn.net/sundaysunshine/article/details/53509854" target="_blank" rel="external">https://blog.csdn.net/sundaysunshine/article/details/53509854</a></p>
<p>除了这两处之外，还需要根据style.xml中的配置，放好闪屏图片，设置闪屏背景。</p>
<p>整个闪屏的原理就是创建一个动画，在动画播放完成之后，去执行一个新的activity。在补全报错的部分之后，还是有一些细节部分需要注意的。</p>
<p>首先是结束时间的判定。判定时机总共有两种，一种是获取动画的进度，就像这里的例子，使用<code>(int)animation.getAnimatedFraction()</code>进行获取一个从0~1的数，来表示目前的动画的播放进度。除此之外还可以获取播放的时间，这个函数是：<code>getAnimatedValue()</code>，它可以获取属性的当前值。使用这两个函数可以很方便地控制动画的时间和动作。</p>
<p>除此之外，在调起另一个Activity之后，我结束了这个Activity。这是因为如果使用默认的LaunchMode，在重新唤醒应用时，闪屏会再次启动，然后走完动画，应用重启。这就造成了应用无法关闭的状况，只能后台强制杀掉。解决办法就是让闪屏只执行一次。</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;去年在接入安卓SDK时，会有部分渠道有要求手写闪屏的情况，下面是当时的笔记，这只是最简单的一种方法。&lt;/p&gt;
&lt;h1 id=&quot;参考资料：&quot;&gt;&lt;a href=&quot;#参考资料：&quot; class=&quot;headerlink&quot; title=&quot;参考资料：&quot;&gt;&lt;/a&gt;参考资料：&lt;/h1&gt;&lt;p&gt;
    
    </summary>
    
    
      <category term="Android" scheme="http://www.z16388.top/tags/Android/"/>
    
  </entry>
  
  <entry>
    <title>安卓各渠道SDK接入体验</title>
    <link href="http://www.z16388.top/2019/11/12/mostsdk/"/>
    <id>http://www.z16388.top/2019/11/12/mostsdk/</id>
    <published>2019-11-12T15:00:23.000Z</published>
    <updated>2019-11-12T15:13:25.279Z</updated>
    
    <content type="html"><![CDATA[<p>去年的这个时候，我在忙于接入各种SDK。接渠道SDK，是一件十分薛定谔的事情。你觉得很容易，的确很容易，但是，也很容易遇到问题。然后我就陷入了长期的自闭状态，再加上偷懒，然后博客就断更了一年。现在回头来回忆一下，去年的这个时候，接入SDK时的那些体验。</p>
<blockquote>
<p>1.酷派</p>
</blockquote>
<p>充值之后，服务器收不到消息，对接也没有人。</p>
<p>现在看来很明显，已然黄了。</p>
<blockquote>
<p>2.应用宝</p>
</blockquote>
<p>传说中的5000人大群只有2个技术的大渠道。每天上午问问题会施舍你两句，下午是肯定不会回答问题的，团建能团建半个月。这个渠道我是使用聚合sdk接入的。需要注意的是，接入时有测试阶段，和正式阶段之分，游戏货币名不能修改，同时还必须接入腾讯的信鸽推送SDK，否则无法过审，手动接入成本极高。</p>
<blockquote>
<p>3.金立</p>
</blockquote>
<p>高版本会造成初次进入闪退，主动获取权限也不行，必须低版本编译。<br>华为手机会出现渲染错误，游戏变成紫红色。<br>需要安装支付插件。<br>现在也应该没有接入的必要了。</p>
<blockquote>
<p>4.华为</p>
</blockquote>
<p>相当棒的渠道，文档详细，对接起来体验也很不错。充值错误的时候，每一步骤，原因都会有显示。<br>但是不支持第三方工具接入。<br>需要安装支付插件。</p>
<blockquote>
<p>5.魅族</p>
</blockquote>
<p>商品id配置不明，会出现莫名的变动，很不靠谱。<br>支付回调生效需要1天的时间，需要对商品进行映射，对接很麻烦的渠道。<br>需要安装支付插件。</p>
<blockquote>
<p>6.360</p>
</blockquote>
<p>包体最大，足足有50多k的方法数，不分包就是死。</p>
<blockquote>
<p>7.百度</p>
</blockquote>
<p>方法数排名第二，仅次于360。<br>高版本编译会无法使用闪屏。<br>提审体验极差。说好的SDK不强用更，但是等到提审后告诉你不合格。</p>
<blockquote>
<p>8.联想</p>
</blockquote>
<p>商品id为自动生成，需要做好映射。<br>AnySDK接入需要注意参数顺序。</p>
<blockquote>
<p>9.UC</p>
</blockquote>
<p>无法使用第三方工具进行接入。<br>闪屏比较蛋疼，在sdk初始化时自动播放。首次运行时无法正常显示，时机不一定，容易和应用闪屏覆盖。</p>
<blockquote>
<p>10.OPPO、VIVO</p>
</blockquote>
<p>无法使用第三方工具进行接入。<br>需要安装支付插件。</p>
<blockquote>
<p>11.小七</p>
</blockquote>
<p>文档描述不明确，注意对登陆回调的处理方式，注重切换账号的测试。<br>SDK的Manifest中，最高宽高比设置为2.2。如果游戏中有对这个参数进行修改，需要进行统一。</p>
<blockquote>
<p>12.拇指玩</p>
</blockquote>
<p>sdk默认背景为透明，会造成有些版本的手机唤起sdk时会显示桌面为背景。或者是切换到主屏后，再回来，只有单独的sdk页面。<br>解决方式是把style.xml中的windowIsTranslucent值置为为false。<br>回调处理方式与其他sdk略有不同,Log与执行功能部分的代码进行了分离。<br>目前版本，无法使用qq登陆等方式，在登陆界面仍没有去掉该入口。</p>
<blockquote>
<p>其他:</p>
</blockquote>
<p>在运营过程中，小米、UC、应用宝和魅族会不同频率出现无法登录的问题，属正常现象，是他们的SDK服务器抽风了，会报一些很可怕的错误，比如应用不存在，应用id无效之类的。这时候只需要稳定好用户的心态即可，没有任何解决办法。 </p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;去年的这个时候，我在忙于接入各种SDK。接渠道SDK，是一件十分薛定谔的事情。你觉得很容易，的确很容易，但是，也很容易遇到问题。然后我就陷入了长期的自闭状态，再加上偷懒，然后博客就断更了一年。现在回头来回忆一下，去年的这个时候，接入SDK时的那些体验。&lt;/p&gt;
&lt;block
    
    </summary>
    
    
      <category term="Android" scheme="http://www.z16388.top/tags/Android/"/>
    
  </entry>
  
  <entry>
    <title>某微信爬虫工具多开方案</title>
    <link href="http://www.z16388.top/2019/11/12/most_wechat/"/>
    <id>http://www.z16388.top/2019/11/12/most_wechat/</id>
    <published>2019-11-12T13:15:53.000Z</published>
    <updated>2019-11-12T13:28:07.569Z</updated>
    
    <content type="html"><![CDATA[<p>之前因为需求找到了这个超级好用的微信爬虫工具<a href="https://github.com/striver-ing/wechat-spider" target="_blank" rel="external">https://github.com/striver-ing/wechat-spider</a>，目前已经开源。工具可以很方便地实现爬取微信文章，获取点赞、评论等功能。</p>
<p>最近，微信针对文章历史接口做了调整：PC版限制了爬取的次数，访问间隔应该控制在8分钟以上，移动端则是在两个月前直接干掉了这个功能。文章评论则没有改变。因此，这个工具目前最好的使用方式就是多开，分别爬不同的文章，再单开一个用来爬需要爬的评论。</p>
<p>工具的具体使用方法在原工程中都有提到，这里就不再赘述了。</p>
<p>在工具的使用方法中，我们知道，作者是使用全局代理，将所有的https消息都强制走了本机的8080端口，然后通过Python的mitmproxy来截取消息内容来实现的这个工具。那么，我可以使用局部代理，将制定的微信客户端，走制定端口，即可实现工具的多开。</p>
<p>有了这个思路，那么我们就只需要解决两个问题：</p>
<ol>
<li>微信的多开</li>
<li>多个微信走多个局部代理</li>
</ol>
<p>这里先说一下，我们无法使用微信PC客户端自带的代理功能。因为一旦这个功能开启，微信的所有链接都将进行加密，你得到的只会是一个格式如：<code><a href="https://xxx.xxx.xx.xx/mmtls/xxxxxx" target="_blank" rel="external">https://xxx.xxx.xx.xx/mmtls/xxxxxx</a></code>的加密链接。</p>
<h1 id="微信的多开"><a href="#微信的多开" class="headerlink" title="微信的多开"></a>微信的多开</h1><p>微信多开的实现比较简单，直接使用bat脚本打开多个微信即可。需要注意的是，要以管理员模式运行。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">@<span class="built_in">echo</span> off</div><div class="line">start /d <span class="string">"C:\Program Files (x86)\Tencent\WeChat\" WeChat.exe</span></div><div class="line">start /d "C:\Program Files (x86)\Tencent\WeChat\<span class="string">" WeChat.exe</span></div><div class="line">start /d "C:\Program Files (x86)\Tencent\WeChat\<span class="string">" WeChat.exe</span></div><div class="line">start /d "C:\Program Files (x86)\Tencent\WeChat\<span class="string">" WeChat.exe</span></div><div class="line">start /d "C:\Program Files (x86)\Tencent\WeChat\<span class="string">" WeChat.exe</span></div><div class="line">exit</div></pre></td></tr></table></figure>
<p>这样虽然可以打开多个微信，但是在设置局部代理时，工具无法区相同路径下的相同可执行文件。因此，我们需要把微信客户端拷贝多份，以应对后面的步骤。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">@<span class="built_in">echo</span> off</div><div class="line">start /d <span class="string">"C:\Program Files (x86)\Tencent\WeChat\" WeChat.exe</span></div><div class="line">start /d "C:\Program Files (x86)\Tencent\WeChatb\<span class="string">" WeChatb.exe</span></div><div class="line">start /d "C:\Program Files (x86)\Tencent\WeChatc\<span class="string">" WeChatc.exe</span></div><div class="line">start /d "C:\Program Files (x86)\Tencent\WeChatd\<span class="string">" WeChatd.exe</span></div><div class="line">start /d "C:\Program Files (x86)\Tencent\WeChate\<span class="string">" WeChate.exe</span></div><div class="line">exit</div></pre></td></tr></table></figure>
<p>需要注意的是，这样配置之后的脚本将不一定百分百执行成功，可能只打开一个客户端。一般第二次即可执行成功。</p>
<h1 id="局部代理"><a href="#局部代理" class="headerlink" title="局部代理"></a>局部代理</h1><p>这里，我使用了Proxifier工具，进行局部代理。这个工具很容易获取，x度上很容易就可以获取到免费破解汉化的版本。</p>
<p>安装之后，我们开始配置工作。</p>
<blockquote>
<p>1.配置文件-&gt;代理服务器  这里地址填本机127.0.0.1，端口填你想要转发的端口，比如8080，8081，协议类型是HTTPS。你想开多少，就填多少个。</p>
<p><img src="https://raw.githubusercontent.com/z16388/blog_pic/master/15735574693277.png" alt="图1"><br><img src="https://raw.githubusercontent.com/z16388/blog_pic/master/15735574693607.png" alt="图2"></p>
<p>2.配置文件-&gt;代理规则    这里我们把默认的全局代理给关闭，双击条目，将“是否有效”取消勾选即可。然后添加微信的代理规则，点击添加，名称随意，应用程序浏览到微信的exe文件，目标主机清空，端口清空，然后在最下方的动作中选择你上一步配置的一个端口。那么这个路径下的客户端执行时，便会代理到这个端口下了。</p>
<p><img src="https://raw.githubusercontent.com/z16388/blog_pic/master/15735574693777.png" alt="图3"><br><img src="https://raw.githubusercontent.com/z16388/blog_pic/master/15735574694007.png" alt="图4"></p>
</blockquote>
<p>微信多开之后，我们会发现多开的这几个的微信的进程名是一样的，无法进行区分。这时候可以在任务管理器中使用切换到、最小化等功能确定哪个窗口是哪个进程，转到本地文件来确定他是哪个目录下的。在开多个的时候，一定要注意区分，以防登错账号，影响爬取。</p>
<p>爬虫的配置文件中，我们最好使用不同的mysql数据库，以免产影响。当然，如果你修改了原工具的代码，那就另当别论了。</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;之前因为需求找到了这个超级好用的微信爬虫工具&lt;a href=&quot;https://github.com/striver-ing/wechat-spider&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;https://github.com/striver-in
    
    </summary>
    
    
      <category term="微信" scheme="http://www.z16388.top/tags/%E5%BE%AE%E4%BF%A1/"/>
    
      <category term="爬虫" scheme="http://www.z16388.top/tags/%E7%88%AC%E8%99%AB/"/>
    
  </entry>
  
  <entry>
    <title>U3D问题总结（八） lua</title>
    <link href="http://www.z16388.top/2019/10/29/unity8/"/>
    <id>http://www.z16388.top/2019/10/29/unity8/</id>
    <published>2019-10-29T15:00:08.000Z</published>
    <updated>2020-10-29T16:34:43.006Z</updated>
    
    <summary type="html">
    
    </summary>
    
    
      <category term="Unity" scheme="http://www.z16388.top/tags/Unity/"/>
    
  </entry>
  
  <entry>
    <title>U3D问题总结（七） C#</title>
    <link href="http://www.z16388.top/2019/10/29/unity7/"/>
    <id>http://www.z16388.top/2019/10/29/unity7/</id>
    <published>2019-10-29T15:00:07.000Z</published>
    <updated>2020-10-29T16:40:46.349Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Net与Mono的关系？"><a href="#Net与Mono的关系？" class="headerlink" title=".Net与Mono的关系？"></a>.Net与Mono的关系？</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mono是.net的一个开源跨平台工具，就类似java虚拟机，java本身不是跨平台语言，但运行在虚拟机上就能够实现了跨平台。.net只能在windows下运行，mono可以实现跨平台跑，可以运行于linux，Unix，Mac OS等。</div></pre></td></tr></table></figure>
<h1 id="C-和C-的区别"><a href="#C-和C-的区别" class="headerlink" title="C#和C++的区别(?"></a>C#和C++的区别(?</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">C# 与C++ 比较的话，最重要的特性就是C# 是一种完全面向对象的语言，而C++ 不是，另外C# 是基于IL 中间语言和.NET Framework CLR 的，在可移植性，可维护性和强壮性都比C++ 有很大的改进。C# 的设计目标是用来开发快速稳定可扩展的应用程序，当然也可以通过Interop 和Pinvoke 完成一些底层操作</div></pre></td></tr></table></figure>
<h1 id="ref参数和out参数是什么？有什么区别-？"><a href="#ref参数和out参数是什么？有什么区别-？" class="headerlink" title="ref参数和out参数是什么？有什么区别(？"></a>ref参数和out参数是什么？有什么区别(？</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ref和out参数的效果一样，都是通过关键字找到定义在主函数里面的变量的内存地址，并通过方法体内的语法改变它的大小。不同点就是输出参数必须对参数进行初始化。ref必须初始化，out 参数必须在函数里赋值。ref参数是引用，out参数为输出参数。</div></pre></td></tr></table></figure>
<h1 id="C-的委托是什么？有何用处"><a href="#C-的委托是什么？有何用处" class="headerlink" title="C#的委托是什么？有何用处"></a>C#的委托是什么？有何用处</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">委托类似于一种安全的指针引用，在使用它时是当做类来看待而不是一个方法，相当于对一组方法的列表的引用。用处：使用委托使程序员可以将方法引用封装在委托对象内。然后可以将该委托对象传递给可调用所引用方法的代码，而不必在编译时知道将调用哪个方法。与C或C++中的函数指针不同，委托是面向对象，而且是类型安全的。</div></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Net与Mono的关系？&quot;&gt;&lt;a href=&quot;#Net与Mono的关系？&quot; class=&quot;headerlink&quot; title=&quot;.Net与Mono的关系？&quot;&gt;&lt;/a&gt;.Net与Mono的关系？&lt;/h1&gt;&lt;figure class=&quot;highlight plain&quot;
    
    </summary>
    
    
      <category term="Unity" scheme="http://www.z16388.top/tags/Unity/"/>
    
  </entry>
  
  <entry>
    <title>U3D问题总结（六） 优化</title>
    <link href="http://www.z16388.top/2019/10/29/unity6/"/>
    <id>http://www.z16388.top/2019/10/29/unity6/</id>
    <published>2019-10-29T15:00:06.000Z</published>
    <updated>2020-10-29T16:32:21.967Z</updated>
    
    <summary type="html">
    
    </summary>
    
    
      <category term="Unity" scheme="http://www.z16388.top/tags/Unity/"/>
    
  </entry>
  
  <entry>
    <title>U3D问题总结（五） 渲染与光照</title>
    <link href="http://www.z16388.top/2019/10/29/unity5/"/>
    <id>http://www.z16388.top/2019/10/29/unity5/</id>
    <published>2019-10-29T15:00:05.000Z</published>
    <updated>2020-10-29T16:38:29.007Z</updated>
    
    <content type="html"><![CDATA[<h1 id="LOD是什么，优缺点"><a href="#LOD是什么，优缺点" class="headerlink" title="LOD是什么，优缺点(?"></a>LOD是什么，优缺点(?</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">LOD(Level of detail)多层次细节，是最常用的游戏优化技术。它按照模型的位置和重要程度决定物体渲染的资源分配，降低非重要物体的面数和细节度，从而获得高效率的渲染运算。缺点是增加了内存。</div></pre></td></tr></table></figure>
<h1 id="MipMap是什么，作用"><a href="#MipMap是什么，作用" class="headerlink" title="MipMap是什么，作用(?"></a>MipMap是什么，作用(?</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">MipMapping：在三维计算机图形的贴图渲染中有常用的技术，为加快渲染进度和减少图像锯齿，贴图被处理成由一系列被预先计算和优化过的图片组成的文件，这样的贴图被称为MipMap。</div></pre></td></tr></table></figure>
<h1 id="什么是LightMap"><a href="#什么是LightMap" class="headerlink" title="什么是LightMap"></a>什么是LightMap</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">LightMap:就是指在三维软件里实现打好光，然后渲染把场景各表面的光照输出到贴图上，最后又通过引擎贴到场景上，这样就使物体有了光照的感觉。</div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;LOD是什么，优缺点&quot;&gt;&lt;a href=&quot;#LOD是什么，优缺点&quot; class=&quot;headerlink&quot; title=&quot;LOD是什么，优缺点(?&quot;&gt;&lt;/a&gt;LOD是什么，优缺点(?&lt;/h1&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;tabl
    
    </summary>
    
    
      <category term="Unity" scheme="http://www.z16388.top/tags/Unity/"/>
    
  </entry>
  
  <entry>
    <title>U3D问题总结（四） 物理相关</title>
    <link href="http://www.z16388.top/2019/10/29/unity4/"/>
    <id>http://www.z16388.top/2019/10/29/unity4/</id>
    <published>2019-10-29T15:00:04.000Z</published>
    <updated>2020-10-29T16:26:31.898Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Unity3d中的碰撞器和触发器的区别？"><a href="#Unity3d中的碰撞器和触发器的区别？" class="headerlink" title="Unity3d中的碰撞器和触发器的区别？"></a>Unity3d中的碰撞器和触发器的区别？</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">碰撞器是触发器的载体，触发器是碰撞器的属性</div><div class="line">Is Trigger=false，碰撞器根据物理引擎引发碰撞，产生碰撞的效果</div><div class="line">此时调用OnCollisionEnter/Stay/Exit函数</div><div class="line">Is Trigger=true，碰撞器被物理引擎所忽略，没有碰撞效果</div><div class="line">此时调用OnTriggerEnter/Stay/Exit函数</div></pre></td></tr></table></figure>
<h1 id="发生碰撞的必要条件"><a href="#发生碰撞的必要条件" class="headerlink" title="发生碰撞的必要条件"></a>发生碰撞的必要条件</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">两个物体都必须带有碰撞器（Collider）</div><div class="line">其中至少有一个物体带有刚体（Rigidbody）或者角色控制器（CharacController）</div><div class="line">必须是运动的物体带有Rigidbody脚本才能检测到碰撞</div></pre></td></tr></table></figure>
<h1 id="物体发生碰撞的过程有几个阶段"><a href="#物体发生碰撞的过程有几个阶段" class="headerlink" title="物体发生碰撞的过程有几个阶段"></a>物体发生碰撞的过程有几个阶段</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">1.OnCollisionEnter  </div><div class="line">2.OnCollisionStay </div><div class="line">3.OnCollisionExit</div></pre></td></tr></table></figure>
<h1 id="Unity3d物理引擎中，有几种施加力的方式（？"><a href="#Unity3d物理引擎中，有几种施加力的方式（？" class="headerlink" title="Unity3d物理引擎中，有几种施加力的方式（？"></a>Unity3d物理引擎中，有几种施加力的方式（？</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">rigidbody.AddForce/AddForceAtPosition，都在rigidbody系列函数中</div></pre></td></tr></table></figure>
<h1 id="CharacterController和Rigdibody的区别"><a href="#CharacterController和Rigdibody的区别" class="headerlink" title="CharacterController和Rigdibody的区别"></a>CharacterController和Rigdibody的区别</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Rigidbody：刚体组件、用于模拟真实的物理效果、可以受到重力和其他力的作用、这个力可以直接施加、也可以来自其他刚体的碰撞</div><div class="line">CharacterController：角色控制组件，它自带一个胶囊控制器，能够受到重力的影响。移动时使用自身的Move()、SimpleMove()方法</div></pre></td></tr></table></figure>
<h1 id="什么叫做链条关节-？"><a href="#什么叫做链条关节-？" class="headerlink" title="什么叫做链条关节(？"></a>什么叫做链条关节(？</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Hinge Joint，可以模拟两个物体间用一根链条连接在一起的情况，能保持两个物体在一个固定距离内部相互移动而不产生作用力，但是达到固定距离后就会产生拉力。</div></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Unity3d中的碰撞器和触发器的区别？&quot;&gt;&lt;a href=&quot;#Unity3d中的碰撞器和触发器的区别？&quot; class=&quot;headerlink&quot; title=&quot;Unity3d中的碰撞器和触发器的区别？&quot;&gt;&lt;/a&gt;Unity3d中的碰撞器和触发器的区别？&lt;/h1&gt;&lt;
    
    </summary>
    
    
      <category term="Unity" scheme="http://www.z16388.top/tags/Unity/"/>
    
  </entry>
  
  <entry>
    <title>U3D问题总结（三） Unity基础</title>
    <link href="http://www.z16388.top/2019/10/29/unity3/"/>
    <id>http://www.z16388.top/2019/10/29/unity3/</id>
    <published>2019-10-29T15:00:03.000Z</published>
    <updated>2020-10-29T16:38:04.256Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Unity3D支持的作为脚本的语言"><a href="#Unity3D支持的作为脚本的语言" class="headerlink" title="Unity3D支持的作为脚本的语言"></a>Unity3D支持的作为脚本的语言</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">C#、JS</div></pre></td></tr></table></figure>
<h1 id="OnEnable、Awake、Start运行时发生的顺序，哪些可以在同一周期中重复发生"><a href="#OnEnable、Awake、Start运行时发生的顺序，哪些可以在同一周期中重复发生" class="headerlink" title="OnEnable、Awake、Start运行时发生的顺序，哪些可以在同一周期中重复发生"></a>OnEnable、Awake、Start运行时发生的顺序，哪些可以在同一周期中重复发生</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Awake-&gt;OnEnable-&gt;Start</div><div class="line">OnEnable可以在同一周期中重复发生</div></pre></td></tr></table></figure>
<h1 id="生命周期"><a href="#生命周期" class="headerlink" title="生命周期"></a>生命周期</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Awake——&gt;OnEnable–&gt;Start——&gt;Update——&gt;FixedUpdate——&gt;LateUpdate——&gt;OnGUI——&gt;OnDisable——&gt;OnDestroy</div></pre></td></tr></table></figure>
<h1 id="物理更新一般放在哪个系统函数里-？"><a href="#物理更新一般放在哪个系统函数里-？" class="headerlink" title="物理更新一般放在哪个系统函数里(？"></a>物理更新一般放在哪个系统函数里(？</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">FixedUpdate，每固定帧绘制时执行一次，和Update不同的是FixedUpdate是渲染帧执行，如果你的渲染效率低下的时候FixedUpdate调用次数就会跟着下降。FixedUpdate比较适用于物理引擎的计算，因为是跟每帧渲染有关。Update就比较适合做控制。</div></pre></td></tr></table></figure>
<h1 id="prefab的作用"><a href="#prefab的作用" class="headerlink" title="prefab的作用"></a>prefab的作用</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">1. 在游戏运行时实例化。Prefab相当于一个模板，对已有的素材、脚本和参数做一个基础的配置，便于以后的修改</div><div class="line">2. Prefab打包的内容简化了导出操作，便于团队协同</div></pre></td></tr></table></figure>
<h1 id="物体自身旋转使用的函数？"><a href="#物体自身旋转使用的函数？" class="headerlink" title="物体自身旋转使用的函数？"></a>物体自身旋转使用的函数？</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Transform.Rotate()</div><div class="line">例如：</div></pre></td></tr></table></figure>
<h1 id="U3D中用于记录节点空间几何信息的组件名称，及其父类名称"><a href="#U3D中用于记录节点空间几何信息的组件名称，及其父类名称" class="headerlink" title="U3D中用于记录节点空间几何信息的组件名称，及其父类名称"></a>U3D中用于记录节点空间几何信息的组件名称，及其父类名称</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Transform 父类是 Component</div></pre></td></tr></table></figure>
<h1 id="如何销毁一个UnityEngine-Object及其子类"><a href="#如何销毁一个UnityEngine-Object及其子类" class="headerlink" title="如何销毁一个UnityEngine.Object及其子类"></a>如何销毁一个UnityEngine.Object及其子类</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Destroy()方法</div></pre></td></tr></table></figure>
<h1 id="为什么Unity3d中会发生在组件上出现数据丢失的情况"><a href="#为什么Unity3d中会发生在组件上出现数据丢失的情况" class="headerlink" title="为什么Unity3d中会发生在组件上出现数据丢失的情况(?"></a>为什么Unity3d中会发生在组件上出现数据丢失的情况(?</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">组件上绑定的物体对象被删除了</div></pre></td></tr></table></figure>
<h1 id="如何安全地在不同工程间安全地迁移asset数据（？"><a href="#如何安全地在不同工程间安全地迁移asset数据（？" class="headerlink" title="如何安全地在不同工程间安全地迁移asset数据（？"></a>如何安全地在不同工程间安全地迁移asset数据（？</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">1. 将Assets目录和Library目录一起迁移</div><div class="line">2. 导出包，export Package</div><div class="line">3. 用unity自带的assets Server功能</div></pre></td></tr></table></figure>
<h1 id="Unity3d实现2d游戏，有几种方式"><a href="#Unity3d实现2d游戏，有几种方式" class="headerlink" title="Unity3d实现2d游戏，有几种方式"></a>Unity3d实现2d游戏，有几种方式</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">1. 使用自身的GUI</div><div class="line">2. 把摄像机的Projection（投影）值调整为Orthographic（正交投影），不考虑z轴</div><div class="line">3. 使用2d的ui插件：2DToolKit、NGUI等</div></pre></td></tr></table></figure>
<h1 id="为何大家都在移动设备上寻求U3D原生GUI的替代方案"><a href="#为何大家都在移动设备上寻求U3D原生GUI的替代方案" class="headerlink" title="为何大家都在移动设备上寻求U3D原生GUI的替代方案"></a>为何大家都在移动设备上寻求U3D原生GUI的替代方案</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">不美观，OnGUI很耗费时间，效率不高，使用不方便</div></pre></td></tr></table></figure>
<h1 id="如何在不同分辨率下保持UI的一致性"><a href="#如何在不同分辨率下保持UI的一致性" class="headerlink" title="如何在不同分辨率下保持UI的一致性(?"></a>如何在不同分辨率下保持UI的一致性(?</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">NGUI很好的解决了这一点，屏幕分辨率的自适应性，原理就是计算出屏幕的宽高比跟原来的预设的屏幕分辨率求出一个对比值，然后修改摄像机的size。UGUI通过锚点和中心点和分辨率也解决这个问题</div></pre></td></tr></table></figure>
<h1 id="在场景中放置多个Camera并同时处于活动状态会发生什么-？"><a href="#在场景中放置多个Camera并同时处于活动状态会发生什么-？" class="headerlink" title="在场景中放置多个Camera并同时处于活动状态会发生什么(？"></a>在场景中放置多个Camera并同时处于活动状态会发生什么(？</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">游戏界面可以看到很多摄像机的混合。</div></pre></td></tr></table></figure>
<h1 id="Unity3d提供了一个用于保存和读取数据的类-PlayerPrefs-，请列出保存和读取整形数据的函数"><a href="#Unity3d提供了一个用于保存和读取数据的类-PlayerPrefs-，请列出保存和读取整形数据的函数" class="headerlink" title="Unity3d提供了一个用于保存和读取数据的类(PlayerPrefs)，请列出保存和读取整形数据的函数"></a>Unity3d提供了一个用于保存和读取数据的类(PlayerPrefs)，请列出保存和读取整形数据的函数</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">PlayerPrefs.SetInt() PlayerPrefs.GetInt()</div></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Unity3D支持的作为脚本的语言&quot;&gt;&lt;a href=&quot;#Unity3D支持的作为脚本的语言&quot; class=&quot;headerlink&quot; title=&quot;Unity3D支持的作为脚本的语言&quot;&gt;&lt;/a&gt;Unity3D支持的作为脚本的语言&lt;/h1&gt;&lt;figure class
    
    </summary>
    
    
      <category term="Unity" scheme="http://www.z16388.top/tags/Unity/"/>
    
  </entry>
  
  <entry>
    <title>U3D问题总结（二） 线性代数</title>
    <link href="http://www.z16388.top/2019/10/29/unity2/"/>
    <id>http://www.z16388.top/2019/10/29/unity2/</id>
    <published>2019-10-29T15:00:02.000Z</published>
    <updated>2020-10-29T16:37:03.529Z</updated>
    
    <content type="html"><![CDATA[<h1 id="向量的点乘、叉乘以及归一化的意义"><a href="#向量的点乘、叉乘以及归一化的意义" class="headerlink" title="向量的点乘、叉乘以及归一化的意义"></a>向量的点乘、叉乘以及归一化的意义</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">1.点乘描述了两个向量的相似程度，结果越大两向量越相似，还可表示投影</div><div class="line">2.叉乘得到的向量垂直于原来的两个向量</div><div class="line">3.标准化向量：用在只关系方向，不关心大小的时候</div></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;向量的点乘、叉乘以及归一化的意义&quot;&gt;&lt;a href=&quot;#向量的点乘、叉乘以及归一化的意义&quot; class=&quot;headerlink&quot; title=&quot;向量的点乘、叉乘以及归一化的意义&quot;&gt;&lt;/a&gt;向量的点乘、叉乘以及归一化的意义&lt;/h1&gt;&lt;figure class=&quot;hi
    
    </summary>
    
    
      <category term="Unity" scheme="http://www.z16388.top/tags/Unity/"/>
    
  </entry>
  
  <entry>
    <title>U3D问题总结（一） 计算机基础</title>
    <link href="http://www.z16388.top/2019/10/29/unity1/"/>
    <id>http://www.z16388.top/2019/10/29/unity1/</id>
    <published>2019-10-29T15:00:01.000Z</published>
    <updated>2020-10-29T16:39:52.600Z</updated>
    
    <content type="html"><![CDATA[<h1 id="结构体和类有何区别"><a href="#结构体和类有何区别" class="headerlink" title="结构体和类有何区别"></a>结构体和类有何区别</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">结构体是一种值类型，而类是引用类型。（值类型、引用类型是根据数据存储的角度来分的）就是值类型用于存储数据的值，引用类型用于存储对实际数据的引用。那么结构体就是当成值来使用的，类则通过引用来对实际数据操作</div></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;结构体和类有何区别&quot;&gt;&lt;a href=&quot;#结构体和类有何区别&quot; class=&quot;headerlink&quot; title=&quot;结构体和类有何区别&quot;&gt;&lt;/a&gt;结构体和类有何区别&lt;/h1&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;t
    
    </summary>
    
    
      <category term="Unity" scheme="http://www.z16388.top/tags/Unity/"/>
    
  </entry>
  
  <entry>
    <title>生成Java版Anysdk的aar</title>
    <link href="http://www.z16388.top/2018/11/10/anysdk/"/>
    <id>http://www.z16388.top/2018/11/10/anysdk/</id>
    <published>2018-11-10T11:46:31.000Z</published>
    <updated>2018-11-10T12:35:18.277Z</updated>
    
    <content type="html"><![CDATA[<p>&emsp;&emsp;在接入Anysdk的时候，我选择了Java的框架。虽然使用Unity版本的会更加方便，直接拖进去就完成了安装步骤，但是不利于控制项目dex文件的大小，不得不进行分包。但是官方提供的是Eclipse的版本，如果想要更好的使用，我们必须把这些东西生成为aar。</p>
<p>&emsp;&emsp;首先，在Android Studio的工程中新建一个library，给的文件拷贝到相应的目录下。需要注意的是，res需要拷贝到src/main/res里。</p>
<p>&emsp;&emsp;如果直接打包的话，我们会发现lib下的armeabi-v7a没有参与打包，缺了so文件怎么能行。这时候，需要在library下的build.gradle中进行配置。</p>
<p>&emsp;&emsp;在buildTypes同级的地方，增加这些代码：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">sourceSets &#123;</div><div class="line">    main &#123;</div><div class="line">        jniLibs.srcDirs = ['libs']</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>&emsp;&emsp;这里指定了，“在libs目录下寻找so文件”。配置好之后，按照anysdk的文档写好java代码，配好manifest，就可以生成anysdk的aar了。</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&amp;emsp;&amp;emsp;在接入Anysdk的时候，我选择了Java的框架。虽然使用Unity版本的会更加方便，直接拖进去就完成了安装步骤，但是不利于控制项目dex文件的大小，不得不进行分包。但是官方提供的是Eclipse的版本，如果想要更好的使用，我们必须把这些东西生成为a
    
    </summary>
    
    
      <category term="Android" scheme="http://www.z16388.top/tags/Android/"/>
    
      <category term="Anysdk" scheme="http://www.z16388.top/tags/Anysdk/"/>
    
      <category term="Unity" scheme="http://www.z16388.top/tags/Unity/"/>
    
  </entry>
  
  <entry>
    <title>Android逆向笔记</title>
    <link href="http://www.z16388.top/2018/11/10/android-d/"/>
    <id>http://www.z16388.top/2018/11/10/android-d/</id>
    <published>2018-11-10T10:32:08.000Z</published>
    <updated>2018-11-10T12:12:42.811Z</updated>
    
    <content type="html"><![CDATA[<p>&emsp;&emsp;这几周，一直在倒腾安卓apk相关的东西，前面那一篇<a href="http://z16388.github.io/2018/10/21/cmdapk" target="_blank" rel="external">命令行修改apk工具</a>就是倒腾的一个中间产物。但是命令行工具还是有它的局限性，随着作死的幅度越来越大已经无法满足我的需求了，便改用python来实现这个工具。大家可以参考这个项目来进行修改<a href="https://github.com/z16388/cs_game_lib" target="_blank" rel="external">https://github.com/z16388/cs_game_lib</a>。后面还有一些扩展的代码没有暂时加入到项目中，打算完善之后提交上去。这篇还会继续更新，可以参考后面的代码结合项目达到你的目的。</p>
<h2 id="关于Apk"><a href="#关于Apk" class="headerlink" title="关于Apk"></a>关于Apk</h2><p>&emsp;&emsp;apk就是一个zip，可以直接解压进行修改，这也是我前一篇中修改apk的方式。但是它不是普通的zip，需要一个签名，否则无法进行安装。但是如果直接进行解压，它里面会有一些二进制化的东西，不方便修改。这时候，我们可以使用apktool进行解包，这样得到的都是文本化的内容了。除此之外，解包比解压能得到更多的res信息，而且不需要我们手动删除签名文件夹。</p>
<h2 id="Apktool"><a href="#Apktool" class="headerlink" title="Apktool"></a>Apktool</h2><p>&emsp;&emsp;Apktool是一个jar文件，官网是<a href="https://ibotpeaches.github.io/Apktool/" target="_blank" rel="external">https://ibotpeaches.github.io/Apktool/</a>。可以参考它的文档进行使用，但是会发现，命令行会变得很奇怪，而且是开了一个新的窗口，我们后面命令行的代码不会顺利执行，就很难受。后来发现，它的命令其实是执行同目录下的一个bat脚本文件，而且是加了参数的。所以，在使用apktool时候，我比较推荐直接调用jar,以解包为例。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">java -jar -Duser.language=zh_cn -Dfile.encoding=UTF-8 apktool.jar d [file name] -o [decode path]</div></pre></td></tr></table></figure>
<p>&emsp;&emsp;我们常用的命令其实就是解包和打包：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">apktool d xxx.apk</div><div class="line">apktool b xxx</div></pre></td></tr></table></figure>
<p>&emsp;&emsp;打包之后，是没有META-INF文件夹的，可以直接签名。关于签名相关的内容可以参考：<a href="http://z16388.github.io/2018/10/21/cmdapk" target="_blank" rel="external">命令行修改apk工具</a>。</p>
<h2 id="APK解包后的结构"><a href="#APK解包后的结构" class="headerlink" title="APK解包后的结构"></a>APK解包后的结构</h2><p>&emsp;&emsp;解包后的APK目录是会变的，如果进行了打包，那么回在该目录下生成一个build目录。但是基础的会有下面这些：</p>
<ul>
<li>assest</li>
<li>lib</li>
<li>original</li>
<li>res</li>
<li>smali</li>
<li>unknown</li>
</ul>
<p>&emsp;&emsp;除此之外，还有文本化的manifest文件。</p>
<p>&emsp;&emsp;想要修改app安装后的名称，可以去res/values/strings.xml，找到app_ame的字段进行修改。</p>
<p>&emsp;&emsp;想要修改权限可以直接修改manifest文件。</p>
<p>&emsp;&emsp;但是想要修改包名就不是那么简单的事情了，需要反编译smali文件成java，修改目录和包名在反编译回去。这个骚操作还是在计划中，暂时没有实现。</p>
<p>&emsp;&emsp;需要注意的是，如果使用Python原生的xml库区修改安卓的xml的时候，会改变xml文件的名空间。原先满页的android名空间变成了奇怪的ag0。这个问题我还在寻找解决方案。如果完成了，那么关于权限和应用名的修改就可以实现自动化了。</p>
<p>&emsp;&emsp;解包的代码如下，可以替换上面github项目中的解压代码。</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#coding=utf-8</span></div><div class="line"> </div><div class="line"><span class="keyword">import</span> os,os.path</div><div class="line"><span class="keyword">from</span> shutil <span class="keyword">import</span> rmtree</div><div class="line"> </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">decode_apk</span><span class="params">(filename, decode_folder)</span>:</span></div><div class="line">    <span class="keyword">if</span> os.path.exists(decode_folder):</div><div class="line">        rmtree(decode_folder)</div><div class="line">        <span class="keyword">print</span> <span class="string">"删除已存在的文件夹"</span>+decode_folder</div><div class="line">    <span class="keyword">print</span> <span class="string">"开始解包"</span>+filename+<span class="string">"-&gt;"</span>+decode_folder</div><div class="line">    apktool_command = <span class="string">"java -jar -Duser.language=zh_cn -Dfile.encoding=UTF8 apktool.jar d "</span> + filename + <span class="string">" -o "</span> + decode_folder</div><div class="line">    os.system(apktool_command)</div><div class="line">    <span class="keyword">print</span> <span class="string">"解包成功"</span>+filename+<span class="string">"-&gt;"</span>+decode_folder</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">build_apk</span><span class="params">(folder, apk_out)</span>:</span></div><div class="line">    <span class="keyword">if</span> os.access(apk_out,os.R_OK):</div><div class="line">        <span class="keyword">print</span> <span class="string">"删除已存在的"</span>+apk_out</div><div class="line">        os.remove(apk_out)</div><div class="line">    <span class="keyword">print</span> <span class="string">"打包中"</span>+apk_out</div><div class="line">    apktool_command = <span class="string">"java -jar -Duser.language=zh_cn -Dfile.encoding=UTF8 apktool.jar b "</span> + folder + <span class="string">" -o "</span> + apk_out</div><div class="line">    os.system(apktool_command)</div><div class="line">    <span class="keyword">print</span> <span class="string">"打包成功"</span>+apk_out</div></pre></td></tr></table></figure>
<p>&emsp;&emsp;脚本需要和apktool.jar在同一目录下，否则命令中需要指定路径。</p>
<h2 id="关于签名"><a href="#关于签名" class="headerlink" title="关于签名"></a>关于签名</h2><p>&emsp;&emsp;打包后签名的方法，在这一篇里已经提到了<a href="http://z16388.github.io/2018/10/21/cmdapk" target="_blank" rel="external">命令行修改apk工具</a>。</p>
<p>&emsp;&emsp;需要注意的是，keystore文件是使用eclipse生成的签名文件，算，如果你的应用是使用Android Studio生成的签名，那将是jks文件。(这可是个不错的番号啊…)</p>
<p>&emsp;&emsp;生成jks文件：在Build菜单中，找到Generate Signed Apk选项，在弹出的窗口中选择Create new，填写相关内容，即可创建签名文件。</p>
<p>&emsp;&emsp;如果非要使用keystore，可以使用keytool进行转换，jks文件经过p12文件中转可以转换成keystore文件，代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">keytool -importkeystore -srckeystore xxx.jks -srcstoretype JKS -deststoretype PKCS12 -destkeystore xxx.p12</div><div class="line">keytool -v -importkeystore -srckeystore xxx.p12 -srcstoretype PKCS12 -destkeystore xxx.keystore -deststoretype JKS</div></pre></td></tr></table></figure>
<p>&emsp;&emsp;除此之外，还可以使用keytool直接生成keystore签名。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">keytool -genkeypair -alias serverkey -keypass 111111 -storepass 111111 -dname &quot;C=CN,ST=GD,L=SZ,O=vihoo,OU=dev,CN=vihoo.com&quot; -keyalg RSA -keysize 2048 -validity 3650 -keystore server.keystore</div></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&amp;emsp;&amp;emsp;这几周，一直在倒腾安卓apk相关的东西，前面那一篇&lt;a href=&quot;http://z16388.github.io/2018/10/21/cmdapk&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;命令行修改apk工具&lt;/a&gt;就是倒
    
    </summary>
    
    
      <category term="Android" scheme="http://www.z16388.top/tags/Android/"/>
    
      <category term="Python" scheme="http://www.z16388.top/tags/Python/"/>
    
  </entry>
  
  <entry>
    <title>关于新版(28, 9.0)Android的坑</title>
    <link href="http://www.z16388.top/2018/11/10/androidversionkeng/"/>
    <id>http://www.z16388.top/2018/11/10/androidversionkeng/</id>
    <published>2018-11-10T09:34:38.000Z</published>
    <updated>2018-11-10T10:16:30.012Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Android-9-0"><a href="#Android-9-0" class="headerlink" title="Android 9.0"></a>Android 9.0</h1><p>&emsp;&emsp;前几天出包就出现了一个非常痛心的事情。发现使用刚发售的，搭载安卓9.0系统的手机无法进行热更的。这就很难受了。各种去查，发现是在10月31日晚上，SDK突然更新了，增加了新的版本28，也就是安卓9.0。</p>
<p>&emsp;&emsp;Unity和安卓9.0的矛盾是，网络相关的东西会受到影响。目前知道的还有Unity的后台统计也是无法使用的，当时清了整个后台，一天多都是白白的，一个Bug都没有，难受。</p>
<p>&emsp;&emsp;解决方法就是到sdk目录中把28给删了，最高版本使用27。然后打出的包解包看一下manifest，确认版本是27，以防止不兼容安卓9.0。这个在传到谷歌商店中构建版本时也是可以确认的。</p>
<h1 id="Android-9-0-1"><a href="#Android-9-0-1" class="headerlink" title="Android 9.0"></a>Android 9.0</h1><p>&emsp;&emsp;在接某第三方sdk的时候遇到了另一个问题，发现他们的sdk在8.0的系统里无法使用。logcat之后发现是他们使用了一个无法在全屏模式下使用的属性。这其实是一个8.0.0版本的bug，在8.1版本中得到了修复，我也用手边的诺基亚7升级了系统，验证了这一点。</p>
<p>&emsp;&emsp;然后他们在第二天就更新了sdk版本，可喜可贺，可喜可贺~</p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Android-9-0&quot;&gt;&lt;a href=&quot;#Android-9-0&quot; class=&quot;headerlink&quot; title=&quot;Android 9.0&quot;&gt;&lt;/a&gt;Android 9.0&lt;/h1&gt;&lt;p&gt;&amp;emsp;&amp;emsp;前几天出包就出现了一个非常痛心的事情。发现使
    
    </summary>
    
    
      <category term="Android" scheme="http://www.z16388.top/tags/Android/"/>
    
  </entry>
  
</feed>
